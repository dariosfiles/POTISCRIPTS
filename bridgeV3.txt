local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/ZanoLeafVN/KavoMobileUI/main/KavoMobile.lua"))()
local Window = Library.CreateLib("Bridge For Brainrot | V4.5", "BloodTheme")

-- Services
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")

-- Variables
local player = Players.LocalPlayer
local searchTerm = ""
local NORMAL_TEXT = "grab"

-- Updated Helper Function with Retry Logic
local function stealBrainrot(targetSmallText)
    local character = player.Character
    local hrp = character and character:FindFirstChild("HumanoidRootPart")
    if not hrp then return end

    local originalCFrame = hrp.CFrame
    local matches = {}

    -- Find matching prompts
    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj:IsA("ProximityPrompt") then
            if string.lower(obj.ObjectText) == string.lower(targetSmallText) and string.lower(obj.ActionText) == NORMAL_TEXT then
                table.insert(matches, obj)
            end
        end
    end

    if #matches > 0 then
        local randomPrompt = matches[math.random(1, #matches)]
        local targetPart = randomPrompt.Parent
        if not targetPart:IsA("BasePart") then return end

        -- Smooth TP to target
        local tween = TweenService:Create(hrp, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {CFrame = targetPart.CFrame * CFrame.new(0, 3, 0)})
        tween:Play()
        tween.Completed:Wait()

        -- Freeze character
        hrp.Anchored = true
        
        -- Retry Loop: Tries 2 times
        for i = 1, 2 do
            print("Attempting " .. targetSmallText .. " - Try #" .. i)
            
            task.wait(0.2)
            randomPrompt:InputHoldBegin()
            task.wait(randomPrompt.HoldDuration)
            randomPrompt:InputHoldEnd()
            
            -- Wait a moment to see if the item was taken/prompt disappeared
            task.wait(0.5)
            
            -- If the prompt is gone or disabled, we succeeded, so stop retrying
            if not randomPrompt.Parent or not randomPrompt.Enabled then
                break
            end
        end
        
        -- Final buffer before returning
        task.wait(0.5)
        hrp.Anchored = false
        hrp.CFrame = originalCFrame
        print("Completed sequence for: " .. targetSmallText)
    else
        print("Not found: " .. targetSmallText)
    end
end

-- TAB 1: PRESETS
local Tab = Window:NewTab("Stealing")
local SectionSteal = Tab:NewSection("Steals Brainrots")
SectionSteal:NewLabel("BETA VERSION")

-- TextBox now triggers on Enter, but also saves text for the button
SectionSteal:NewTextBox("BRAINROT NAME", "Type name and press ENTER", function(txt)
    searchTerm = txt
    if txt ~= "" then
        stealBrainrot(txt)
    end
end)

SectionSteal:NewButton("GO FIND! âœ…", "Searches for that brainrot", function()
    if searchTerm ~= "" then
        stealBrainrot(searchTerm)
    end
end)

SectionSteal:NewButton("Steal Garama", "Steals that brainrot", function() 
    stealBrainrot("garama and madundung") 
end)

SectionSteal:NewButton("Steal Los Matteos", "Steals that brainrot", function() 
    stealBrainrot("los matteos") 
end)
